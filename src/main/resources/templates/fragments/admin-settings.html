<div
  xmlns:th="http://www.thymeleaf.org"
  th:fragment="settingsSection"
  class="space-y-2"
>
  <h2 class="text-white text-2xl font-bold">
    <span th:text="#{adminPanel.settings}">Settings</span>
  </h2>

  <form
    th:if="${isAdmin}"
    th:action="@{/admin/settings/registration-domain}"
    method="post"
    class="mt-4 max-w-xl space-y-4"
  >
    <input
      type="hidden"
      th:name="${_csrf.parameterName}"
      th:value="${_csrf.token}"
    />

    <div class="rounded-2xl border border-white/15 bg-white/5 p-4 space-y-3">
      <div class="flex items-center justify-between gap-3">
        <div class="min-w-0">
          <div class="flex items-center gap-2">
            <span class="text-white font-semibold text-sm">
              Limit registration by email domain
            </span>
            <span
              class="inline-flex items-center rounded-full bg-white/10 px-2 py-0.5 text-[11px] font-medium text-white/70"
            >
              Admin only
            </span>
          </div>
          <p class="text-white/70 text-xs mt-1">
            When enabled, only email addresses ending with the specified domain
            can register.
          </p>
        </div>

        <label
          class="relative inline-flex cursor-pointer items-center flex-shrink-0"
        >
          <input
            type="checkbox"
            name="enforceDomain"
            class="sr-only peer"
            th:checked="${registrationDomainEnforced}"
          />
          <div
            class="relative h-5 w-10 rounded-full border border-white/10 bg-white/10 transition peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-white/20 peer-checked:border-emerald-500/40 peer-checked:bg-emerald-500/30 after:absolute after:left-0.5 after:top-0.5 after:h-4 after:w-4 after:rounded-full after:bg-white/70 after:transition-all peer-checked:after:translate-x-5"
          ></div>
        </label>
      </div>

      <div class="space-y-1">
        <label
          for="allowedDomain"
          class="block text-xs font-medium text-white/80"
        >
          Allowed email domain
        </label>
        <div class="flex flex-col sm:flex-row gap-2">
          <div class="relative flex-1 min-w-0">
            <div
              class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-white/60 text-xs"
            >
              @
            </div>
            <input
              id="allowedDomain"
              name="allowedDomain"
              type="text"
              inputmode="email"
              autocomplete="off"
              placeholder="school.edu"
              th:value="${registrationDomainDisplay}"
              class="bg-white/10 text-white text-sm rounded-lg pl-7 pr-3 h-9 border border-white/15 focus:outline-none focus:ring-2 focus:ring-white/25 w-full placeholder:text-white/40"
            />
          </div>
        </div>
        <p class="text-[11px] text-white/60">
          Enter a domain like <span class="font-mono">school.edu</span>. Users
          will only be able to register with emails ending in this domain when
          the toggle is on.
        </p>
      </div>
    </div>

    <div class="flex items-center gap-2">
      <button
        type="submit"
        class="inline-flex items-center justify-center gap-2 rounded-lg border border-emerald-500/40 bg-emerald-500/25 px-4 h-9 text-sm font-medium text-emerald-50 hover:bg-emerald-500/35 transition"
      >
        <i class="fas fa-save text-xs"></i>
        <span>Save settings</span>
      </button>

      <div
        th:if="${registrationDomainEnforced}"
        class="inline-flex items-center gap-2 rounded-full border border-amber-400/40 bg-amber-500/10 px-3 h-8 text-[11px] font-medium text-amber-100"
      >
        <i class="fas fa-circle-info text-xs"></i>
        <span>
          Registration limited to @<span
            class="font-mono"
            th:text="${registrationDomainDisplay}"
            >domain.com</span
          >
        </span>
      </div>
    </div>
  </form>

  <div
    th:if="${!isAdmin}"
    class="mt-4 max-w-xl rounded-2xl border border-white/15 bg-white/5 p-4 text-sm text-white/75"
  >
    <div class="font-semibold text-white">Registration email domain</div>
    <p class="mt-1 text-xs text-white/70">
      Only Admin users can change registration domain settings. Please contact
      an Admin if you need to update this policy.
    </p>
  </div>
</div>
